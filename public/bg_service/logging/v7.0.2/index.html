<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="html">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.144.0">
    <meta name="generator" content="Relearn 7.6.1+4407b4364ab6f7477f7671fbd20c0494bade40ee">
    <meta name="description" content="Versionslatest7.0.2Purposes Separate log folder for services Limit log file size Limit the number of log files Separate log file for job Usage Configure log builder Call AddBgServiceFileLogger() on the logging builder to add a custom file logger provider. using Juice.BgService.Extensions.Logging; ... var builder = WebApplication.CreateBuilder(args); builder.Logging.AddBgServiceFileLogger(builder.Configuration.GetSection(&#34;Logging:File&#34;));Logging:File configuration section may be present:">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Logging :: Juice&#39;s documentation">
    <meta name="twitter:description" content="Versionslatest7.0.2Purposes Separate log folder for services Limit log file size Limit the number of log files Separate log file for job Usage Configure log builder Call AddBgServiceFileLogger() on the logging builder to add a custom file logger provider. using Juice.BgService.Extensions.Logging; ... var builder = WebApplication.CreateBuilder(args); builder.Logging.AddBgServiceFileLogger(builder.Configuration.GetSection(&#34;Logging:File&#34;));Logging:File configuration section may be present:">
    <meta property="og:url" content="http://example.org/bg_service/logging/v7.0.2/index.html">
    <meta property="og:site_name" content="Juice&#39;s documentation">
    <meta property="og:title" content="Logging :: Juice&#39;s documentation">
    <meta property="og:description" content="Versionslatest7.0.2Purposes Separate log folder for services Limit log file size Limit the number of log files Separate log file for job Usage Configure log builder Call AddBgServiceFileLogger() on the logging builder to add a custom file logger provider. using Juice.BgService.Extensions.Logging; ... var builder = WebApplication.CreateBuilder(args); builder.Logging.AddBgServiceFileLogger(builder.Configuration.GetSection(&#34;Logging:File&#34;));Logging:File configuration section may be present:">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="website">
    <meta itemprop="name" content="Logging :: Juice&#39;s documentation">
    <meta itemprop="description" content="Versionslatest7.0.2Purposes Separate log folder for services Limit log file size Limit the number of log files Separate log file for job Usage Configure log builder Call AddBgServiceFileLogger() on the logging builder to add a custom file logger provider. using Juice.BgService.Extensions.Logging; ... var builder = WebApplication.CreateBuilder(args); builder.Logging.AddBgServiceFileLogger(builder.Configuration.GetSection(&#34;Logging:File&#34;));Logging:File configuration section may be present:">
    <meta itemprop="datePublished" content="2023-04-03T21:02:02+07:00">
    <meta itemprop="dateModified" content="2023-04-03T21:02:02+07:00">
    <meta itemprop="wordCount" content="202">
    <title>Logging :: Juice&#39;s documentation</title>
    <link href="/bg_service/logging/v7.0.2/index.xml" rel="alternate" type="application/rss+xml" title="Logging :: Juice&#39;s documentation">
    <link href="/images/favicon.png?1750824110" rel="icon" type="image/png">
    <link href="/images/favicon.ico?1750824110" rel="icon" type="image/x-icon" sizes="any">
    <link href="/fonts/fontawesome/css/fontawesome-all.min.css?1750824110" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/fonts/fontawesome/css/fontawesome-all.min.css?1750824110" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar/perfect-scrollbar.min.css?1750824110" rel="stylesheet">
    <link href="/css/theme.min.css?1750824110" rel="stylesheet">
    <link href="/css/format-html.min.css?1750824110" rel="stylesheet" id="R-format-style">
    <link href="/css/auto-complete/auto-complete.min.css?1750824110" rel="stylesheet">
    <script src="/js/auto-complete/auto-complete.min.js?1750824110" defer></script>
    <script src="/js/lunr/lunr.min.js?1750824110" defer></script>
    <script src="/js/lunr/lunr.stemmer.support.min.js?1750824110" defer></script>
    <script src="/js/lunr/lunr.multi.min.js?1750824110" defer></script>
    <script src="/js/lunr/lunr.en.min.js?1750824110" defer></script>
    <script src="/js/search.min.js?1750824110" defer></script>
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = `.min`;
      window.relearn.path='\/bg_service\/logging\/v7.0.2\/index.html';
      window.relearn.relBasePath='..\/..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='http:\/\/example.org';
      window.relearn.contentLangs=['en'];
      window.relearn.index_js_url="/searchindex.en.js?1750824110";
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.relearn.disableInlineCopyToClipboard=false;
      window.relearn.enableBlockCodeWrap=true;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // variant stuff
      window.relearn.themevariants = [ 'mine' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>
  </head>
  <body class="mobile-support html" data-url="/bg_service/logging/v7.0.2/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper"> 
                </div>
              </div>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList">
            <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/index.html"><span itemprop="name">Juice&#39;s documentation</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li>
            <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/bg_service/index.html"><span itemprop="name">Background service</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li>
            <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><span itemprop="name">Logging</span><meta itemprop="position" content="3">&nbsp;>&nbsp;</li>
            <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><span itemprop="name">Logging</span><meta itemprop="position" content="4"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-edit" data-content-empty="disable" data-width-s="area-more" data-width-m="show" data-width-l="show"><a class="topbar-control" href="https://github.com/creatorflow-io/juice-docs/tree/master/content/bg_service/logging/v7.0.2/_index.md" rel="external" target="_blank" title="Edit (CTRL+ALT+w)"><i class="fa-fw fas fa-pen"></i></a>
            </div>
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/bg_service/logging/whatsnew/index.html" title="What's New in BgService Logging 7.0.3 (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><span class="topbar-control"><i class="fa-fw fas fa-chevron-right"></i></span>
            </div>
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable bg_service" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="logging">Logging</h1>




    
    
    <div style="display: flex;">    
        <label style="padding-right: 10px;" page-version=7.0.2>Versions</label>
        <select id="versionSelect" style="width: 100px;">
            
                <option  value=latest>latest</option>
            
                <option  selected  value=7.0.2>7.0.2</option>
            
        </select>
    </div>
    <script>
        var select = document.getElementById('versionSelect');
        select.addEventListener('change', function() {
            let path = window.location.pathname.trimEnd('/');
            let version = select.value;
            if (version == 'latest') {
                version = '';
            }else{
                version = 'v' + version;
            }
            
            
            let regex = new RegExp('\/v[0-9]+.[0-9]+.[0-9]+');
            path = path.replace(regex, '');
            
            window.location.href = window.location.origin + path + '/' + version;
        });
    </script>
    


<h4 id="purposes">Purposes</h4>
<ul>
<li>Separate log folder for services</li>
<li>Limit log file size</li>
<li>Limit the number of log files</li>
<li>Separate log file for job</li>
</ul>
<h4 id="usage">Usage</h4>
<ol>
<li><strong>Configure log builder</strong>
Call <em>AddBgServiceFileLogger()</em> on the logging builder to add a custom file logger provider.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#66d9ef">using</span> Juice.BgService.Extensions.Logging;
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> builder = WebApplication.CreateBuilder(args);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>builder.Logging.AddBgServiceFileLogger(builder.Configuration.GetSection(<span style="color:#e6db74">&#34;Logging:File&#34;</span>));</span></span></code></pre></div>
<p><em>Logging:File</em> configuration section may be present:</p>
<ul>
<li><em>Directory</em></li>
<li><em>RetainPolicyFileCount</em>: default value is <strong>50</strong></li>
<li><em>MaxFileSize</em>: default value is <strong>5 * 1024 * 1024</strong>;</li>
<li><em>ForkJobLog</em>: default value is <strong>true</strong></li>
</ul>
<ol start="2">
<li>
<h5 id="separate-logs-by-scope">Separate logs by scope</h5>
</li>
</ol>
<p>To separate logs folder, we will init new log scope with specified properties:</p>
<ul>
<li><em>ServiceId</em>: Guid value</li>
<li><em>ServiceDescription</em>: string value</li>
</ul>
<p>You may want to store <em>_logScope</em> to dispose it later.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#75715e">// {Logging:File:Directory}/{ServiceDescription}/{yyyy_MM_dd-HHmm}.log</span>
</span></span><span style="display:flex;"><span>_logScope = _logger.BeginScope(<span style="color:#66d9ef">new</span> List&lt;KeyValuePair&lt;<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">object</span>&gt;&gt;
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> KeyValuePair&lt;<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">object</span>&gt;(<span style="color:#e6db74">&#34;ServiceId&#34;</span>, Id),
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> KeyValuePair&lt;<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">object</span>&gt;(<span style="color:#e6db74">&#34;ServiceDescription&#34;</span>, Description)
</span></span><span style="display:flex;"><span>});</span></span></code></pre></div>
<p>To separate log file for job, we will init new log scope with specified properties:</p>
<ul>
<li><em>JobId</em>: string value</li>
<li><em>JobDescription</em>: string value</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#75715e">// {Logging:File:Directory}/{ServiceDescription}/{JobId} - {JobDescription}.log</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> (_logger.BeginScope(<span style="color:#66d9ef">new</span> List&lt;KeyValuePair&lt;<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">object</span>&gt;&gt;
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> KeyValuePair&lt;<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">object</span>&gt;(<span style="color:#e6db74">&#34;JobId&#34;</span>, JobId),
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> KeyValuePair&lt;<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">object</span>&gt;(<span style="color:#e6db74">&#34;JobDescription&#34;</span>, JobDescription)
</span></span><span style="display:flex;"><span>})){
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// job processing</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// {Logging:File:Directory}/{ServiceDescription}/{JobId} - {JobDescription}_{JobState}.log</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// {Logging:File:Directory}/{ServiceDescription}/{JobId} - {JobDescription}_{JobState} (attempted).log</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> (_logger.BeginScope(<span style="color:#66d9ef">new</span> List&lt;KeyValuePair&lt;<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">object</span>&gt;&gt;
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> KeyValuePair&lt;<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">object</span>&gt;(<span style="color:#e6db74">&#34;JobId&#34;</span>, JobId),
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> KeyValuePair&lt;<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">object</span>&gt;(<span style="color:#e6db74">&#34;JobDescription&#34;</span>, JobDescription),
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> KeyValuePair&lt;<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">object</span>&gt;(<span style="color:#e6db74">&#34;JobState&#34;</span>, JobState)
</span></span><span style="display:flex;"><span>})){
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// job is completed with state</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>

  <footer class="footline">
              <i class='fa-fw fas fa-calendar'></i> Apr 3, 2023
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">

        </div>
        <search><form action="/search/index.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
      </div>
      <div id="R-homelinks" class="default-animation homelinks">
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-homelinks">
          <ul class="space collapsible-menu">
            <li class="" data-nav-id="/index.html"><a class="padding" href="/index.html"><i class="fa-fw fas fa-home"></i> Home</a></li>
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-headercontrols">
          <ul class="">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div class="R-sidebarmenu R-shortcutmenu-main">
          <ul class="enlarge morespace collapsible-menu">
            <li class="" data-nav-id="/overview/index.html"><a class="padding" href="/overview/index.html"><b>1. </b>Overview</a><ul id="R-subsections-0545e563276d3ac6e3218cfecf67a14b" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/quickstart/index.html"><a class="padding" href="/quickstart/index.html"><b>2. </b>Quickstarts</a><ul id="R-subsections-d63193e927818b6cb77d9c791ea48a61" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/core/index.html"><a class="padding" href="/core/index.html"><b>3. </b>Core features</a><ul id="R-subsections-ae20cee98ae962b39919c99c9fa7e1c8" class="collapsible-menu"></ul></li>
            <li class="parent " data-nav-id="/bg_service/index.html"><a class="padding" href="/bg_service/index.html"><b>4. </b>Background service</a><ul id="R-subsections-91ddeaef7589de0de564e5ca3c5ae84c" class="collapsible-menu">
            <li class="" data-nav-id="/bg_service/managed_service/index.html"><a class="padding" href="/bg_service/managed_service/index.html">Manageable services</a></li></ul></li>
            <li class="" data-nav-id="/other_services/index.html"><a class="padding" href="/other_services/index.html"><b>5. </b>Other services</a><ul id="R-subsections-499bf1af617ed2be177da5b5e1438bc4" class="collapsible-menu"></ul></li>
          </ul>
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-shortcuts">
          <div class="nav-title padding">More</div>
          <ul class="space collapsible-menu">
            <li class="" data-nav-id="https://github.com/creatorflow-io/Juice"><a class="padding" href="https://github.com/creatorflow-io/Juice" rel="external" target="_blank"><i class='fab fa-github'></i> Github repo</a></li>
          </ul>
        </div>
        <div id="R-footer-margin"></div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-footercontrols">
          <ul class="">
          </ul>
        </div>
<div id="R-footer"><p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p></div>
      </div>
    </aside>
    <script src="/js/clipboard/clipboard.min.js?1750824110" defer></script>
    <script src="/js/perfect-scrollbar/perfect-scrollbar.min.js?1750824110" defer></script>
    <script src="/js/theme.min.js?1750824110" defer></script>
  </body>
</html>
